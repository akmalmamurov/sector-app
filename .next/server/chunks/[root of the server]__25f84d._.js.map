{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file://D%3A/project/sector-app/src/app/api/auth/%5Bprovider%5D/callback/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nexport async function GET(\r\n  req: Request,\r\n  { params }: { params: { provider: string } }\r\n) {\r\n  const { searchParams } = new URL(req.url);\r\n  const token = searchParams.get(\"token\");\r\n\r\n  if (!token) {\r\n    // Токен бўлмаса логин саҳифасига йўналтириш\r\n    return NextResponse.redirect(\"/login\");\r\n  }\r\n\r\n  // HTTP-only, Secure, SameSite=None cookie ўрнатиш\r\n  cookies().set({\r\n    name: \"sector-token\",\r\n    value: token,\r\n    httpOnly: true, // XSS ҳужумларидан ҳимоя :contentReference[oaicite:3]{index=3}\r\n    secure: true, // faqat HTTPS да :contentReference[oaicite:4]{index=4}\r\n    sameSite: \"none\", // cross-site redirect’ларга рухсат :contentReference[oaicite:5]{index=5}\r\n    path: \"/\",\r\n    maxAge: 7 * 24 * 60 * 60,\r\n  });\r\n\r\n  // Фойдаланувчини профил саҳифасига йўналтириш\r\n  return NextResponse.redirect(\"/profile\");\r\n}\r\n\r\nexport const dynamic = \"force-dynamic\";\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IACpB,GAAY,EACZ,EAAE,MAAM,EAAoC;IAE5C,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,QAAQ,aAAa,GAAG,CAAC;IAE/B,IAAI,CAAC,OAAO;QACV,4CAA4C;QAC5C,OAAO,gIAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,kDAAkD;IAClD,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC;QACZ,MAAM;QACN,OAAO;QACP,UAAU;QACV,QAAQ;QACR,UAAU;QACV,MAAM;QACN,QAAQ,IAAI,KAAK,KAAK;IACxB;IAEA,8CAA8C;IAC9C,OAAO,gIAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;AAC/B;AAEO,MAAM,UAAU"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}